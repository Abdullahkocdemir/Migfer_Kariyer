@using Migfer_Kariyer.Entities
@model List<SocialMedia>
@{
    ViewData["Title"] = "Sosyal Medya Listesi";
    Layout = "~/Views/Layout/Index.cshtml";
}

<style>
    .success-message {
        background-color: #d4edda;
        color: #155724;
        padding: 15px 20px;
        margin: 20px 30px;
        border-radius: 8px;
        border: 1px solid #c3e6cb;
        font-weight: 500;
    }

    .error-message {
        background-color: #f8d7da;
        color: #721c24;
        padding: 15px 20px;
        margin: 20px 30px;
        border-radius: 8px;
        border: 1px solid #f5c6cb;
        font-weight: 500;
    }

    .social-url {
        font-weight: 500;
        color: #2c3e50;
        font-size: 14px;
        padding: 8px 12px;
        background: linear-gradient(135deg, #0f0f0f, #000000);
        border-radius: 6px;
        border-left: 3px solid #6f42c1;
        min-height: 30px;
        display: flex;
        align-items: center;
        word-break: break-all;
    }

    .social-icon {
        font-size: 24px;
        text-align: center;
        padding: 10px;
        border-radius: 50%;
        display: inline-block;
        min-width: 45px;
        color: white;
        box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
        margin-right: 8px;
    }

    .facebook { background: linear-gradient(135deg, #1877f2, #0e4085); }
    .twitter { background: linear-gradient(135deg, #1da1f2, #0d8bd1); }
    .instagram { background: linear-gradient(135deg, #e4405f, #833ab4); }
    .linkedin { background: linear-gradient(135deg, #0077b5, #005885); }
    .youtube { background: linear-gradient(135deg, #ff0000, #cc0000); }
    .discord { background: linear-gradient(135deg, #7289da, #5865f2); }

    .social-count {
        background: linear-gradient(135deg, #6f42c1, #563d7c);
        color: white;
        padding: 6px 12px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: bold;
        display: inline-block;
        box-shadow: 0 2px 8px rgba(111, 66, 193, 0.3);
    }

    .platform-info {
        color: #6c757d;
        font-size: 11px;
        margin-top: 3px;
        font-style: italic;
    }

    .empty-url {
        color: #6c757d;
        font-style: italic;
        font-size: 12px;
        background: rgba(108, 117, 125, 0.1);
        border-left-color: #6c757d;
    }

    /* SADECE SweetAlert için modern stiller */
    .swal2-popup {
        border-radius: 20px !important;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15) !important;
        border: none !important;
        padding: 2.5em !important;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
    }

    .swal2-title {
        font-size: 26px !important;
        font-weight: 700 !important;
        margin-bottom: 25px !important;
        color: #2d3436 !important;
    }

    .swal2-html-container {
        font-size: 16px !important;
        line-height: 1.6 !important;
        color: #636e72 !important;
        margin: 20px 0 !important;
    }

    .swal2-confirm {
        background: linear-gradient(135deg, #00b894, #00cec9) !important;
        border: none !important;
        border-radius: 50px !important;
        padding: 14px 32px !important;
        font-size: 16px !important;
        font-weight: 600 !important;
        box-shadow: 0 8px 25px rgba(0, 184, 148, 0.3) !important;
        transition: all 0.3s ease !important;
    }

    .swal2-confirm:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 12px 35px rgba(0, 184, 148, 0.4) !important;
    }

    .swal2-cancel {
        background: linear-gradient(135deg, #636e72, #495057) !important;
        border: none !important;
        border-radius: 50px !important;
        padding: 14px 32px !important;
        font-size: 16px !important;
        font-weight: 600 !important;
        box-shadow: 0 8px 25px rgba(99, 110, 114, 0.3) !important;
        transition: all 0.3s ease !important;
    }

    .swal2-cancel:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 12px 35px rgba(99, 110, 114, 0.4) !important;
    }

    .swal2-icon {
        margin: 25px auto !important;
        width: 85px !important;
        height: 85px !important;
    }

    .delete-confirm .swal2-confirm {
        background: linear-gradient(135deg, #e17055, #d63031) !important;
        box-shadow: 0 8px 25px rgba(225, 112, 85, 0.3) !important;
    }

    .delete-confirm .swal2-confirm:hover {
        box-shadow: 0 12px 35px rgba(225, 112, 85, 0.4) !important;
    }

    .swal2-loader {
        border-color: #00b894 transparent #00b894 transparent !important;
    }

    @@keyframes modernFadeIn {
        0% {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
        }
        100% {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    .modern-animation {
        animation: modernFadeIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    }

    /* Ripple efekti için CSS */
    .action-btn {
        position: relative;
        overflow: hidden;
    }

    .ripple {
        position: absolute;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.6);
        animation: ripple-animation 0.6s linear;
        pointer-events: none;
    }

    @@keyframes ripple-animation {
        to {
            transform: scale(2);
            opacity: 0;
        }
    }

    /* Responsive tasarım */
    @@media (max-width: 768px) {
        .data-table table {
            font-size: 14px;
        }

        .social-url {
            font-size: 12px;
            padding: 6px 8px;
        }

        .social-icon {
            font-size: 20px;
            min-width: 35px;
        }

        .action-btn {
            padding: 6px 10px;
            font-size: 12px;
        }

        .swal2-popup {
            width: 90% !important;
            padding: 1.5em !important;
        }
    }

    @@media (max-width: 480px) {
        .table-header {
            flex-direction: column;
            gap: 15px;
        }

        .table-title {
            text-align: center;
        }

        .add-btn {
            align-self: center;
        }
    }

    /* Print stilleri */
    @@media print {
        .action-btn {
            display: none;
        }

        .table-header .add-btn {
            display: none;
        }

        .success-message,
        .error-message {
            display: none;
        }
    }
</style>

<!-- SweetAlert2 CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- Social Media Table -->
<div class="data-table">
    <div class="table-header">
        <div class="table-title">🌐 Sosyal Medya Yönetimi</div>
        <a asp-action="Create" class="add-btn">+ Yeni Sosyal Medya Ekle</a>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="success-message">
            ✅ @TempData["SuccessMessage"]
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="error-message">
            ❌ @TempData["ErrorMessage"]
        </div>
    }

    @if (Model != null && Model.Any())
    {
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Facebook</th>
                    <th>Twitter</th>
                    <th>Instagram</th>
                    <th>LinkedIn</th>
                    <th>YouTube</th>
                    <th>Discord</th>
                    <th>Platform Sayısı</th>
                    <th>İşlemler</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    var activeCount = 0;
                    if (!string.IsNullOrEmpty(item.FacebookUrl)) activeCount++;
                    if (!string.IsNullOrEmpty(item.TwitterUrl)) activeCount++;
                    if (!string.IsNullOrEmpty(item.InstagramUrl)) activeCount++;
                    if (!string.IsNullOrEmpty(item.LinkedinUrl)) activeCount++;
                    if (!string.IsNullOrEmpty(item.YoutubeUrl)) activeCount++;
                    if (!string.IsNullOrEmpty(item.DiscordUrl)) activeCount++;
                    <tr>
                        <td>
                            <div class="social-icon" style="background: linear-gradient(135deg, #6f42c1, #563d7c);">🌐</div>
                            @item.Id
                        </td>
                        <td>
                            <div style="color:wheat" class="social-url @(string.IsNullOrEmpty(item.FacebookUrl) ? "empty-url" : "")">
                                @if (!string.IsNullOrEmpty(item.FacebookUrl))
                                {
                                    <span class="social-icon facebook">📘</span>
                                    @item.FacebookUrl
                                }
                                else
                                {
                                    <span>Belirtilmemiş</span>
                                }
                            </div>
                        </td>
                        <td>
                            <div style="color:wheat" class="social-url @(string.IsNullOrEmpty(item.TwitterUrl) ? "empty-url" : "")">
                                @if (!string.IsNullOrEmpty(item.TwitterUrl))
                                {
                                    <span class="social-icon twitter">🐦</span>
                                    @item.TwitterUrl
                                }
                                else
                                {
                                    <span>Belirtilmemiş</span>
                                }
                            </div>
                        </td>
                        <td>
                            <div style="color:wheat" class="social-url @(string.IsNullOrEmpty(item.InstagramUrl) ? "empty-url" : "")">
                                @if (!string.IsNullOrEmpty(item.InstagramUrl))
                                {
                                    <span class="social-icon instagram">📸</span>
                                    @item.InstagramUrl
                                }
                                else
                                {
                                    <span>Belirtilmemiş</span>
                                }
                            </div>
                        </td>
                        <td>
                            <div style="color:wheat" class="social-url @(string.IsNullOrEmpty(item.LinkedinUrl) ? "empty-url" : "")">
                                @if (!string.IsNullOrEmpty(item.LinkedinUrl))
                                {
                                    <span class="social-icon linkedin">💼</span>
                                    @item.LinkedinUrl
                                }
                                else
                                {
                                    <span>Belirtilmemiş</span>
                                }
                            </div>
                        </td>
                        <td>
                            <div style="color:wheat" class="social-url @(string.IsNullOrEmpty(item.YoutubeUrl) ? "empty-url" : "")">
                                @if (!string.IsNullOrEmpty(item.YoutubeUrl))
                                {
                                    <span class="social-icon youtube">📺</span>
                                    @item.YoutubeUrl
                                }
                                else
                                {
                                    <span>Belirtilmemiş</span>
                                }
                            </div>
                        </td>
                        <td>
                            <div style="color:wheat" class="social-url @(string.IsNullOrEmpty(item.DiscordUrl) ? "empty-url" : "")">
                                @if (!string.IsNullOrEmpty(item.DiscordUrl))
                                {
                                    <span class="social-icon discord">🎮</span>
                                    @item.DiscordUrl
                                }
                                else
                                {
                                    <span>Belirtilmemiş</span>
                                }
                            </div>
                        </td>
                        <td>
                            <div class="social-count">
                                🌐 @activeCount / 6 Platform
                            </div>
                            <div class="platform-info">
                                @if (activeCount == 6)
                                {
                                    <span>Tüm platformlar aktif</span>
                                }
                                else if (activeCount > 0)
                                {
                                    <span>@(6 - activeCount) platform eksik</span>
                                }
                                else
                                {
                                    <span>Henüz platform eklenmemiş</span>
                                }
                            </div>
                        </td>
                        <td>
                            <a asp-action="Details" asp-route-id="@item.Id" class="action-btn view-btn">Görüntüle</a>
                            <a asp-action="Edit" asp-route-id="@item.Id" class="action-btn edit-btn">Düzenle</a>
                            <button onclick="confirmDelete(@item.Id)" class="action-btn delete-btn">Sil</button>
                        </td>
                    </tr>
                }

            </tbody>
        </table>
    }
    else
    {
        <div class="empty-state">
            <h4>🌐 Henüz sosyal medya hesabı eklenmemiş</h4>
            <p>İlk sosyal medya hesaplarınızı eklemek için aşağıdaki butona tıklayın.</p>
            <a asp-action="Create" class="add-btn">🌐 İlk Sosyal Medya Hesaplarını Ekle</a>
        </div>
    }
</div>

<!-- Gizli Delete Formu -->
<form id="deleteForm" method="post" style="display: none;">
    @Html.AntiForgeryToken()
</form>

<script>
    function confirmDelete(socialMediaId) {
        Swal.fire({
            title: '🗑️ Sosyal Medya Silme Onayı',
            html: `
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 18px; color: #636e72; margin-bottom: 15px; line-height: 1.5;">
                        Bu sosyal medya hesap bilgilerini kalıcı olarak silmek istediğinizden emin misiniz?
                    </div>
                    <div style="font-size: 14px; color: #e17055; background: linear-gradient(135deg, rgba(225, 112, 85, 0.1), rgba(225, 112, 85, 0.05)); padding: 15px 20px; border-radius: 12px; margin-top: 20px; border-left: 4px solid #e17055;">
                        ⚠️ Bu işlem geri alınamaz!
                    </div>
                </div>
            `,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#e17055',
            cancelButtonColor: '#6c757d',
            confirmButtonText: '🗑️ Evet, Sil!',
            cancelButtonText: '🛡️ Vazgeç',
            reverseButtons: true,
            focusCancel: true,
            width: '520px',
            padding: '2.5em',
            showClass: {
                popup: 'modern-animation'
            },
            customClass: {
                popup: 'delete-confirm'
            }
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire({
                    title: '🔄 Siliniyor...',
                    html: `
                        <div style="text-align: center; padding: 25px;">
                            <div style="font-size: 18px; color: #74b9ff; font-weight: 500; margin-bottom: 15px;">
                                Sosyal medya hesap bilgileri siliniyor...
                            </div>
                            <div style="font-size: 14px; color: #636e72; opacity: 0.8;">
                                Lütfen bekleyiniz...
                            </div>
                        </div>
                    `,
                    icon: 'info',
                    allowOutsideClick: false,
                    showConfirmButton: false,
                    width: '480px',
                    showClass: {
                        popup: 'modern-animation'
                    },
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                // Form gönderimi
                const form = document.getElementById('deleteForm');
                form.action = `/AdminSocialMedia/Delete/${socialMediaId}`;
                form.submit();
            }
        });
    }

    // Sayfa yüklendikinde başarı/hata mesajlarını göster
    document.addEventListener('DOMContentLoaded', function() {
        @if (TempData["SuccessMessage"] != null)
        {
            <text>
            Swal.fire({
                title: '🎉 İşlem Başarılı!',
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 20px; color: #00b894; font-weight: 600; margin-bottom: 15px;">
                            @TempData["SuccessMessage"]
                        </div>
                        <div style="font-size: 15px; color: #636e72; opacity: 0.9; line-height: 1.5;">
                            İşleminiz başarıyla tamamlandı.
                        </div>
                        <div style="font-size: 13px; color: #00b894; margin-top: 15px; padding: 10px; background: rgba(0, 184, 148, 0.1); border-radius: 8px;">
                            ✨ Değişiklikler kaydedildi
                        </div>
                    </div>
                `,
                icon: 'success',
                confirmButtonText: '🎯 Tamam!',
                confirmButtonColor: '#00b894',
                width: '520px',
                padding: '2.5em',
                showClass: {
                    popup: 'modern-animation'
                },
                timer: 4000,
                timerProgressBar: true
            });
            </text>
        }

        @if (TempData["ErrorMessage"] != null)
        {
            <text>
            Swal.fire({
                title: '🚨 Bir Hata Oluştu!',
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 20px; color: #e17055; font-weight: 600; margin-bottom: 15px;">
                            @TempData["ErrorMessage"]
                        </div>
                        <div style="font-size: 15px; color: #636e72; opacity: 0.9; line-height: 1.5; margin-bottom: 15px;">
                            İşlem gerçekleştirilemedi. Lütfen tekrar deneyiniz.
                        </div>
                        <div style="font-size: 13px; color: #e17055; padding: 12px; background: rgba(225, 112, 85, 0.1); border-radius: 8px; border-left: 3px solid #e17055;">
                            💡 Sorun devam ederse destek alın
                        </div>
                    </div>
                `,
                icon: 'error',
                confirmButtonText: '🔄 Tamam',
                confirmButtonColor: '#e17055',
                width: '520px',
                padding: '2.5em',
                showClass: {
                    popup: 'modern-animation'
                }
            });
            </text>
        }

        // Tablo satırları için hover efekti
        document.querySelectorAll('tbody tr').forEach(row => {
            row.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.01)';
                this.style.transition = 'all 0.3s ease';
                this.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.1)';
            });

            row.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = 'none';
            });
        });

        // Buton animasyonları
        document.querySelectorAll('.action-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                if (!this.disabled && this.style.cursor !== 'not-allowed') {
                    // Ripple efekti
                    const ripple = document.createElement('span');
                    const rect = this.getBoundingClientRect();
                    const size = Math.max(rect.width, rect.height);
                    const x = e.clientX - rect.left - size / 2;
                    const y = e.clientY - rect.top - size / 2;

                    ripple.style.width = ripple.style.height = size + 'px';
                    ripple.style.left = x + 'px';
                    ripple.style.top = y + 'px';
                    ripple.classList.add('ripple');

                    this.appendChild(ripple);

                    setTimeout(() => {
                        ripple.remove();
                    }, 600);
                }
            });
        });
    });
</script>