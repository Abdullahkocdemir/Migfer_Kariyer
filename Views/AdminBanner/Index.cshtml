@using Migfer_Kariyer.Entities
@model List<Banner>
@{
    ViewData["Title"] = "Banner Listesi";
    Layout = "~/Views/Layout/Index.cshtml";
}

<style>
    .success-message {
        background-color: #d4edda;
        color: #155724;
        padding: 15px 20px;
        margin: 20px 30px;
        border-radius: 8px;
        border: 1px solid #c3e6cb;
        font-weight: 500;
    }

    .error-message {
        background-color: #f8d7da;
        color: #721c24;
        padding: 15px 20px;
        margin: 20px 30px;
        border-radius: 8px;
        border: 1px solid #f5c6cb;
        font-weight: 500;
    }

    .banner-title {
        font-weight: bold;
        color: #2c3e50;
        font-size: 16px;
    }

    .banner-description {
        color: #6c757d;
        font-size: 14px;
        margin-top: 5px;
    }

    .video-link {
        color: #007bff;
        text-decoration: none;
        font-size: 13px;
        word-break: break-all;
    }

        .video-link:hover {
            color: #0056b3;
            text-decoration: underline;
        }

    .empty-video {
        color: #6c757d;
        font-style: italic;
        font-size: 13px;
    }

    /* SADECE SweetAlert için modern stiller */
    .swal2-popup {
        border-radius: 20px !important;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15) !important;
        border: none !important;
        padding: 2.5em !important;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
    }

    .swal2-title {
        font-size: 26px !important;
        font-weight: 700 !important;
        margin-bottom: 25px !important;
        color: #2d3436 !important;
    }

    .swal2-html-container {
        font-size: 16px !important;
        line-height: 1.6 !important;
        color: #636e72 !important;
        margin: 20px 0 !important;
    }

    .swal2-confirm {
        background: linear-gradient(135deg, #00b894, #00cec9) !important;
        border: none !important;
        border-radius: 50px !important;
        padding: 14px 32px !important;
        font-size: 16px !important;
        font-weight: 600 !important;
        box-shadow: 0 8px 25px rgba(0, 184, 148, 0.3) !important;
        transition: all 0.3s ease !important;
    }

        .swal2-confirm:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 12px 35px rgba(0, 184, 148, 0.4) !important;
        }

    .swal2-cancel {
        background: linear-gradient(135deg, #636e72, #495057) !important;
        border: none !important;
        border-radius: 50px !important;
        padding: 14px 32px !important;
        font-size: 16px !important;
        font-weight: 600 !important;
        box-shadow: 0 8px 25px rgba(99, 110, 114, 0.3) !important;
        transition: all 0.3s ease !important;
    }

        .swal2-cancel:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 12px 35px rgba(99, 110, 114, 0.4) !important;
        }

    .swal2-icon {
        margin: 25px auto !important;
        width: 85px !important;
        height: 85px !important;
    }

    .delete-confirm .swal2-confirm {
        background: linear-gradient(135deg, #e17055, #d63031) !important;
        box-shadow: 0 8px 25px rgba(225, 112, 85, 0.3) !important;
    }

        .delete-confirm .swal2-confirm:hover {
            box-shadow: 0 12px 35px rgba(225, 112, 85, 0.4) !important;
        }

    .swal2-loader {
        border-color: #00b894 transparent #00b894 transparent !important;
    }

    @@keyframes modernFadeIn {
        0%

    {
        opacity: 0;
        transform: scale(0.8) translateY(20px);
    }

    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }

    }

    .modern-animation {
        animation: modernFadeIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
    }
</style>

<!-- SweetAlert2 CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- Banner Table -->
<div class="data-table">
    <div class="table-header">
        <div class="table-title">🎬 Banner Yönetimi</div>
        <a asp-action="Create" class="add-btn">+ Yeni Banner Ekle</a>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="success-message">
            ✅ @TempData["SuccessMessage"]
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="error-message">
            ❌ @TempData["ErrorMessage"]
        </div>
    }

    @if (Model != null && Model.Any())
    {
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Başlık</th>
                    <th>Küçük Açıklama</th>
                    <th>Video URL</th>
                    <th>İşlemler</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.Id</td>
                        <td>
                            <div class="banner-title">@item.Başlık</div>
                        </td>
                        <td>
                            <div class="banner-description">@item.KüçükAçıklama</div>
                        </td>
                        <td>
                            @if (!string.IsNullOrEmpty(item.VideoUrl))
                            {
                                <a href="@item.VideoUrl" target="_blank" class="video-link">
                                    🎥 Video Linki
                                </a>
                                <div style="font-size: 11px; color: #999; margin-top: 2px;">
                                    @(item.VideoUrl.Length > 50 ? item.VideoUrl.Substring(0, 50) + "..." : item.VideoUrl)
                                </div>
                            }
                            else
                            {
                                <span class="empty-video">Video belirtilmemiş</span>
                            }
                        </td>
                        <td>
                            <a asp-action="Details" asp-route-id="@item.Id" class="action-btn view-btn">Görüntüle</a>
                            <a asp-action="Edit" asp-route-id="@item.Id" class="action-btn edit-btn">Düzenle</a>
                            <button onclick="confirmDelete(@item.Id, '@item.Başlık')" class="action-btn delete-btn">Sil</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <div class="empty-state">
            <h4>🎬 Henüz banner eklenmemiş</h4>
            <p>İlk banner'ınızı eklemek için aşağıdaki butona tıklayın.</p>
            <a asp-action="Create" class="add-btn">🎬 İlk Banner'ı Ekle</a>
        </div>
    }
</div>

<!-- Gizli Delete Formu -->
<form id="deleteForm" method="post" style="display: none;">
    @Html.AntiForgeryToken()
</form>

<script>
    function confirmDelete(bannerId, bannerTitle) {
        Swal.fire({
            title: '🗑️ Banner Silme Onayı',
            html: `
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 22px; color: #2d3436; font-weight: 600; margin-bottom: 20px;">
                        <strong style="color: #e17055;">"${bannerTitle}"</strong>
                    </div>
                    <div style="font-size: 16px; color: #636e72; margin-bottom: 15px; line-height: 1.5;">
                        Bu banner'ı kalıcı olarak silmek istediğinizden emin misiniz?
                    </div>
                    <div style="font-size: 14px; color: #e17055; background: linear-gradient(135deg, rgba(225, 112, 85, 0.1), rgba(225, 112, 85, 0.05)); padding: 15px 20px; border-radius: 12px; margin-top: 20px; border-left: 4px solid #e17055;">
                        ⚠️ Bu işlem geri alınamaz!
                    </div>
                </div>
            `,
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#e17055',
            cancelButtonColor: '#6c757d',
            confirmButtonText: '🗑️ Evet, Sil!',
            cancelButtonText: '🛡️ Vazgeç',
            reverseButtons: true,
            focusCancel: true,
            width: '580px',
            padding: '2.5em',
            showClass: {
                popup: 'modern-animation'
            },
            customClass: {
                popup: 'delete-confirm'
            }
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire({
                    title: '🔄 Siliniyor...',
                    html: `
                        <div style="text-align: center; padding: 25px;">
                            <div style="font-size: 18px; color: #74b9ff; font-weight: 500; margin-bottom: 15px;">
                                Banner silme işlemi gerçekleştiriliyor...
                            </div>
                            <div style="font-size: 14px; color: #636e72; opacity: 0.8;">
                                Lütfen bekleyiniz...
                            </div>
                        </div>
                    `,
                    icon: 'info',
                    allowOutsideClick: false,
                    showConfirmButton: false,
                    width: '480px',
                    showClass: {
                        popup: 'modern-animation'
                    },
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                const form = document.getElementById('deleteForm');
                form.action = `/AdminBanner/Delete/${bannerId}`;
                form.submit();
            }
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
        @if (TempData["SuccessMessage"] != null)
        {
                <text>
                Swal.fire({
                    title: '🎉 İşlem Başarılı!',
                    html: `
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 20px; color: #00b894; font-weight: 600; margin-bottom: 15px;">
                                @TempData["SuccessMessage"]
                            </div>
                            <div style="font-size: 15px; color: #636e72; opacity: 0.9; line-height: 1.5;">
                                İşleminiz başarıyla tamamlandı.
                            </div>
                            <div style="font-size: 13px; color: #00b894; margin-top: 15px; padding: 10px; background: rgba(0, 184, 148, 0.1); border-radius: 8px;">
                                ✨ Değişiklikler kaydedildi
                            </div>
                        </div>
                    `,
                    icon: 'success',
                    confirmButtonText: '🎯 Tamam!',
                    confirmButtonColor: '#00b894',
                    width: '520px',
                    padding: '2.5em',
                    showClass: {
                        popup: 'modern-animation'
                    },
                    timer: 4000,
                    timerProgressBar: true
                });
                </text>
        }

        @if (TempData["ErrorMessage"] != null)
        {
                <text>
                Swal.fire({
                    title: '🚨 Bir Hata Oluştu!',
                    html: `
                        <div style="text-align: center; padding: 20px;">
                            <div style="font-size: 20px; color: #e17055; font-weight: 600; margin-bottom: 15px;">
                                @TempData["ErrorMessage"]
                            </div>
                            <div style="font-size: 15px; color: #636e72; opacity: 0.9; line-height: 1.5; margin-bottom: 15px;">
                                İşlem gerçekleştirilemedi. Lütfen tekrar deneyiniz.
                            </div>
                            <div style="font-size: 13px; color: #e17055; padding: 12px; background: rgba(225, 112, 85, 0.1); border-radius: 8px; border-left: 3px solid #e17055;">
                                💡 Sorun devam ederse destek alın
                            </div>
                        </div>
                    `,
                    icon: 'error',
                    confirmButtonText: '🔄 Tamam',
                    confirmButtonColor: '#e17055',
                    width: '520px',
                    padding: '2.5em',
                    showClass: {
                        popup: 'modern-animation'
                    }
                });
                </text>
        }
    });
</script>